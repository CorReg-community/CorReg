<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Quick tutorial for CorReg package — CorReg-package • CorReg</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Quick tutorial for CorReg package — CorReg-package" />
<meta property="og:description" content="Sequential linear regression based on a structural equation model (explicit correlations). 
It permits to face highly correlated datasets.
We first search for an explicit model of correlations within the covariates by linear regression, 
then this structure is interpreted and used to reduce dimension and correlations for the main regression on the response variable." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CorReg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.19</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/CorReg.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/CorReg-community/CorReg/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Quick tutorial for CorReg package</h1>
    <small class="dont-index">Source: <a href='https://github.com/CorReg-community/CorReg/blob/master/R/CorReg-package.R'><code>R/CorReg-package.R</code></a></small>
    <div class="hidden name"><code>CorReg-package.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Sequential linear regression based on a structural equation model (explicit correlations). 
It permits to face highly correlated datasets.
We first search for an explicit model of correlations within the covariates by linear regression, 
then this structure is interpreted and used to reduce dimension and correlations for the main regression on the response variable.</p>
    </div>



    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>CorReg: see <a href='http://www.correg.org'>http://www.correg.org</a> for article and Phd Thesis about CorReg.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Model-based covariable decorrelation in linear regression (CorReg): application to missing data and to steel industry. C Thery - 2015. 
See <a href='http://www.theses.fr/2015LIL10060'>http://www.theses.fr/2015LIL10060</a> to read the associated PhD Thesis.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Clement THERY &lt;clement.thery@arcelormittal.com&gt;</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1</span>)
<span class='co'># dataset generation</span>
<span class='kw'>base</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mixture_generator.html'>mixture_generator</a></span>(n = <span class='fl'>15</span>, p = <span class='fl'>10</span>, ratio = <span class='fl'>0.4</span>, tp1 = <span class='fl'>1</span>, tp2 = <span class='fl'>1</span>, tp3 = <span class='fl'>1</span>,
                          positive = <span class='fl'>0.5</span>, R2Y = <span class='fl'>0.8</span>, R2 = <span class='fl'>0.9</span>, scale = <span class='fl'>TRUE</span>, 
                          max_compl = <span class='fl'>3</span>, lambda = <span class='fl'>1</span>)

<span class='kw'>X_appr</span> <span class='op'>&lt;-</span> <span class='kw'>base</span><span class='op'>$</span><span class='kw'>X_appr</span> <span class='co'># learning sample</span>
<span class='kw'>Y_appr</span> <span class='op'>&lt;-</span> <span class='kw'>base</span><span class='op'>$</span><span class='kw'>Y_appr</span> <span class='co'># response variable for the learning sample</span>
<span class='kw'>Y_test</span> <span class='op'>&lt;-</span> <span class='kw'>base</span><span class='op'>$</span><span class='kw'>Y_test</span> <span class='co'># responsee variable for the validation sample</span>
<span class='kw'>X_test</span> <span class='op'>&lt;-</span> <span class='kw'>base</span><span class='op'>$</span><span class='kw'>X_test</span> <span class='co'># validation sample</span>
   
<span class='kw'>TrueZ</span> <span class='op'>&lt;-</span> <span class='kw'>base</span><span class='op'>$</span><span class='kw'>Z</span> <span class='co'># True generative structure (binary adjacency matrix)</span>
<span class='co'># Z_i,j=1 means that Xj linearly depends on Xi</span>
   
 
<span class='co'># density estimation for the MCMC (with Gaussian Mixtures)</span>
<span class='kw'>density</span> <span class='op'>&lt;-</span> <span class='fu'><a href='density_estimation.html'>density_estimation</a></span>(X = <span class='kw'>X_appr</span>, nbclustmax = <span class='fl'>8</span>, detailed = <span class='fl'>TRUE</span>)
<span class='kw'>Bic_null_vect</span> <span class='op'>&lt;-</span> <span class='kw'>density</span><span class='op'>$</span><span class='kw'>BIC_vect</span> <span class='co'># vector of the BIC found (1 value per covariate)</span>
   
<span class='co'># MCMC to find the structure</span>
<span class='kw'>res</span> <span class='op'>=</span> <span class='fu'><a href='structureFinder.html'>structureFinder</a></span>(X = <span class='kw'>X_appr</span>, verbose = <span class='fl'>0</span>, reject = <span class='fl'>0</span>, Maxiter = <span class='fl'>900</span>, nbini = <span class='fl'>20</span>,
                      candidates = <span class='op'>-</span><span class='fl'>1</span>, Bic_null_vect = <span class='kw'>Bic_null_vect</span>, star = <span class='fl'>TRUE</span>, 
                      p1max = <span class='fl'>15</span>, clean = <span class='fl'>TRUE</span>)
<span class='kw'>hatZ</span> <span class='op'>=</span> <span class='kw'>res</span><span class='op'>$</span><span class='kw'>Z_opt</span> <span class='co'># found structure (adjacency matrix)</span>
<span class='kw'>hatBic</span> <span class='op'>=</span> <span class='kw'>res</span><span class='op'>$</span><span class='kw'>bic_opt</span> <span class='co'># associated BIC</span>

<span class='co'># BIC comparison between true and found structure</span>
<span class='kw'>bicopt_vect</span> <span class='op'>=</span> <span class='fu'><a href='BicZ.html'>BicZ</a></span>(X = <span class='kw'>X_appr</span>, Z = <span class='kw'>hatZ</span>, Bic_null_vect = <span class='kw'>Bic_null_vect</span>)
<span class='kw'>bicopt_true</span> <span class='op'>=</span> <span class='fu'><a href='BicZ.html'>BicZ</a></span>(X = <span class='kw'>X_appr</span>, Z = <span class='kw'>TrueZ</span>, Bic_null_vect = <span class='kw'>Bic_null_vect</span>)
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='kw'>bicopt_vect</span>)</div><div class='output co'>#&gt; [1] 259.9427</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='kw'>bicopt_true</span>)</div><div class='output co'>#&gt; [1] 268.9612</div><div class='input'>
<span class='co'># Structure comparison</span>
<span class='kw'>compZ</span> <span class='op'>=</span> <span class='fu'><a href='compare_struct.html'>compare_struct</a></span>(trueZ = <span class='kw'>TrueZ</span>, Zalgo = <span class='kw'>hatZ</span>) <span class='co'># qualitative comparison</span>

<span class='co'># interpretation of found and true structure ordered by increasing R2</span>
<span class='co'># &lt;NA&gt;line: name of subregressed covariate</span>
<span class='fu'><a href='readZ.html'>readZ</a></span>(Z = <span class='kw'>hatZ</span>, crit = <span class='st'>"R2"</span>, X = <span class='kw'>X_appr</span>, output = <span class='st'>"all"</span>, order = <span class='fl'>1</span>) </div><div class='output co'>#&gt; [[1]]
#&gt;                coefs       var
#&gt; 1  0.756688931044162        R2
#&gt; 2               &lt;NA&gt;         4
#&gt; 3  0.859624940069372 intercept
#&gt; 4   -0.1399117868683         2
#&gt; 5 0.0753356912115381         5
#&gt; 6 -0.420585132044892         6
#&gt; 7  0.386889952414899         8
#&gt; 8  0.158399928444675        10
#&gt; 
#&gt; [[2]]
#&gt;                coefs       var
#&gt; 1  0.911860461449336        R2
#&gt; 2               &lt;NA&gt;         1
#&gt; 3   0.91932024337823 intercept
#&gt; 4  0.117452195745483         2
#&gt; 5 -0.253074594237159         5
#&gt; 6  0.140264670180811         8
#&gt; 7  -0.41875113197976        10
#&gt; 
#&gt; [[3]]
#&gt;                coefs       var
#&gt; 1  0.923279184954364        R2
#&gt; 2               &lt;NA&gt;         9
#&gt; 3   0.72615680052669 intercept
#&gt; 4 -0.478981431253879         3
#&gt; 5  -0.13537277411296         5
#&gt; 6  0.466653365456346         8
#&gt; 7 -0.345854851769902        10
#&gt; 
#&gt; [[4]]
#&gt;                 coefs       var
#&gt; 1   0.959993325124032        R2
#&gt; 2                &lt;NA&gt;         7
#&gt; 3  -0.903716709197091 intercept
#&gt; 4   0.252418293426256         2
#&gt; 5  -0.157191523221045         3
#&gt; 6  -0.199826875526643         5
#&gt; 7 -0.0670800344425359         6
#&gt; </div><div class='input'><span class='fu'><a href='readZ.html'>readZ</a></span>(Z = <span class='kw'>TrueZ</span>, crit = <span class='st'>"R2"</span>, X = <span class='kw'>X_appr</span>, output = <span class='st'>"all"</span>, order = <span class='fl'>1</span>)</div><div class='output co'>#&gt; [[1]]
#&gt;                coefs       var
#&gt; 1  0.714662171588836        R2
#&gt; 2               &lt;NA&gt;         4
#&gt; 3   0.84058604515217 intercept
#&gt; 4 -0.360058365453026         6
#&gt; 5  0.305086409282352         8
#&gt; 6   0.21237655098617        10
#&gt; 
#&gt; [[2]]
#&gt;                coefs       var
#&gt; 1  0.876810338540551        R2
#&gt; 2               &lt;NA&gt;         1
#&gt; 3  0.883968620534446 intercept
#&gt; 4  0.188189202428782         2
#&gt; 5 -0.234780886884954         5
#&gt; 6 -0.372082898411495        10
#&gt; 
#&gt; [[3]]
#&gt;                coefs       var
#&gt; 1  0.890792585053809        R2
#&gt; 2               &lt;NA&gt;         9
#&gt; 3  0.700168743089247 intercept
#&gt; 4 -0.534495903177699         3
#&gt; 5  0.384756709283009         8
#&gt; 6 -0.361609689733513        10
#&gt; 
#&gt; [[4]]
#&gt;                coefs       var
#&gt; 1  0.947197030815705        R2
#&gt; 2               &lt;NA&gt;         7
#&gt; 3 -0.897165694819893 intercept
#&gt; 4  0.253322024128277         2
#&gt; 5 -0.180820187525035         3
#&gt; 6 -0.210790435701806         5
#&gt; </div><div class='input'>
<span class='co'># Regression coefficients estimation</span>
<span class='kw'>select</span> <span class='op'>=</span> <span class='st'>"NULL"</span> <span class='co'># without variable selection (otherwise,  choose "lar" for example)</span>
<span class='kw'>resY</span> <span class='op'>=</span> <span class='fu'><a href='correg.html'>correg</a></span>(X = <span class='kw'>X_appr</span>, Y = <span class='kw'>Y_appr</span>, Z = <span class='kw'>hatZ</span>, compl = <span class='fl'>TRUE</span>, expl = <span class='fl'>TRUE</span>, pred = <span class='fl'>TRUE</span>, 
              select = <span class='kw'>select</span>, K = <span class='fl'>10</span>)

<span class='co'># MSE computation</span>
<span class='kw'>MSE_complete</span> <span class='op'>=</span> <span class='fu'><a href='MSE_loc.html'>MSE_loc</a></span>(Y = <span class='kw'>Y_test</span>, X = <span class='kw'>X_test</span>, A = <span class='kw'>resY</span><span class='op'>$</span><span class='kw'>compl</span><span class='op'>$</span><span class='kw'>A</span>) <span class='co'># classical model on X</span>
<span class='kw'>MSE_marginal</span> <span class='op'>=</span> <span class='fu'><a href='MSE_loc.html'>MSE_loc</a></span>(Y = <span class='kw'>Y_test</span>, X = <span class='kw'>X_test</span>, A = <span class='kw'>resY</span><span class='op'>$</span><span class='kw'>expl</span><span class='op'>$</span><span class='kw'>A</span>) <span class='co'># reduced model without correlations</span>
<span class='kw'>MSE_plugin</span> <span class='op'>=</span> <span class='fu'><a href='MSE_loc.html'>MSE_loc</a></span>(Y = <span class='kw'>Y_test</span>, X = <span class='kw'>X_test</span>, A = <span class='kw'>resY</span><span class='op'>$</span><span class='kw'>pred</span><span class='op'>$</span><span class='kw'>A</span>) <span class='co'># plug-in model</span>
<span class='kw'>MSE_true</span> <span class='op'>=</span> <span class='fu'><a href='MSE_loc.html'>MSE_loc</a></span>(Y = <span class='kw'>Y_test</span>, X = <span class='kw'>X_test</span>, A = <span class='kw'>base</span><span class='op'>$</span><span class='kw'>A</span>) <span class='co'># True model</span>
   
   
<span class='co'># MSE comparison</span>
<span class='kw'>MSE</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>MSE_complete</span>, <span class='kw'>MSE_marginal</span>, <span class='kw'>MSE_plugin</span>, <span class='kw'>MSE_true</span>)
<span class='kw'>MSE</span> <span class='co'># estimated structure</span></div><div class='output co'>#&gt;   MSE_complete MSE_marginal MSE_plugin MSE_true
#&gt; 1     441.0069     374.0534    391.176 174.9802</div><div class='input'><span class='kw'>compZ</span><span class='op'>$</span><span class='kw'>true_left</span></div><div class='output co'>#&gt; [1] 4</div><div class='input'><span class='kw'>compZ</span><span class='op'>$</span><span class='kw'>false_left</span></div><div class='output co'>#&gt; [1] 0</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/graphics/barplot.html'>barplot</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='kw'>MSE</span>), main = <span class='st'>"MSE on validation dataset"</span>,  
        sub = <span class='st'>"Results obtained without selection method (lasso and other are available)"</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span>(h = <span class='kw'>MSE_complete</span>, col = <span class='st'>"red"</span>)</div><div class='img'><img src='CorReg-package-1.png' alt='' width='700' height='433' /></div><div class='input'></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Clement Thery.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


